<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>×—×•×‘×•×ª ×”×œ×‘×‘×•×ª - ××—×©×‘×•×Ÿ ×ª××—×•×¨</title>
<link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700;800&family=Heebo:wght@300;400;500;700;800&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Assistant','Heebo',sans-serif;direction:rtl}
input[type=range]{cursor:pointer;height:18px}
select{cursor:pointer}
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const {useState,useEffect,useMemo,useRef}=React;
const h=React.createElement;

// â•â•â• DATA â•â•â•
const DD={
  eventTypes:["PRM","OFS","CKT","BRC","RNT"],
  eL:{PRM:"PRM - ×¤×¨×™××™×•×",OFS:"OFS - ××•×¤×¡×™×™×˜",CKT:"CKT - ×§×•×§×˜×œ×™×",BRC:"BRC - ×‘×¨×× ×¥'",RNT:"RNT - ×”×©×›×¨×ª ×—×œ×œ"},
  inp:{
    ADT:{PRM:"15-80",OFS:"10-70",CKT:"15-80",BRC:"15-80",RNT:"15-80"},
    CHD:{PRM:"0-20",OFS:"NR",CKT:"0-20",BRC:"0-20",RNT:"0-20"},
    FOD:{PRM:"IC",OFS:"YN",CKT:"IC",BRC:"IC",RNT:"NR"},
    KSH:{PRM:"YN",OFS:"YN",CKT:"YN",BRC:"YN",RNT:"NR"},
    WTR:{PRM:"CMP",OFS:"012",CKT:"CMP",BRC:"CMP",RNT:"012"},
    PRO:{PRM:"012",OFS:"012",CKT:"012",BRC:"012",RNT:"012"},
    CRK:{PRM:"YN",OFS:"YN",CKT:"YN",BRC:"YN",RNT:"NR"},
    CER:{PRM:"YN",OFS:"YN",CKT:"YN",BRC:"YN",RNT:"NR"},
    FLW:{PRM:"IC",OFS:"YN",CKT:"IC",BRC:"IC",RNT:"YN"},
    WIN:{PRM:"IC",OFS:"YN",CKT:"IC",BRC:"IC",RNT:"YN"},
    WINP:{PRM:"YN",OFS:"NR",CKT:"YN",BRC:"YN",RNT:"NR"},
    KIT:{PRM:"NR",OFS:"YN",CKT:"NR",BRC:"NR",RNT:"YN"},
  },
  pr:{
    IBASE:{PRM:9900,OFS:5500,CKT:7050,BRC:8250,RNT:5500},
    IMORE:{PRM:550,OFS:500,CKT:470,BRC:500,RNT:"f"},
    ICRK:{PRM:1000,OFS:1000,CKT:1000,BRC:1000,RNT:0},
    IPRO:{PRM:75,OFS:75,CKT:75,BRC:75,RNT:0},
    ICER:{PRM:350,OFS:350,CKT:350,BRC:350,RNT:0},
    IWINP:{PRM:60,OFS:60,CKT:60,BRC:60,RNT:0},
    IKIT:{PRM:0,OFS:150,CKT:0,BRC:0,RNT:1000},
    IFLW:{PRM:0,OFS:1200,CKT:0,BRC:1200,RNT:1200},
    IWIN:{PRM:0,OFS:70,CKT:70,BRC:70,RNT:70},
    IKSH:{PRM:1500,OFS:1500,CKT:1500,BRC:1500,RNT:1500},
    OCHEFB:{PRM:2100,OFS:1200,CKT:1400,BRC:1400,RNT:0},
    OCHEF1:{PRM:40,OFS:0,CKT:40,BRC:40,RNT:0},
    OCHEF2:{PRM:0,OFS:30,CKT:0,BRC:0,RNT:0},
    OCOOK:{PRM:20,OFS:28,CKT:28,BRC:28,RNT:0},
    OFOOD:{PRM:70,OFS:70,CKT:55,BRC:70,RNT:0},
    OPRO2:{PRM:20,OFS:20,CKT:20,BRC:20,RNT:0},
    OCER:{PRM:175,OFS:175,CKT:175,BRC:175,RNT:0},
    OWINP:{PRM:10,OFS:10,CKT:10,BRC:10,RNT:0},
    OFLW:{PRM:800,OFS:800,CKT:800,BRC:800,RNT:800},
    OWIN:{PRM:20,OFS:20,CKT:20,BRC:20,RNT:20},
    OKSH:{PRM:1000,OFS:1000,CKT:1000,BRC:1000,RNT:1000},
    OCLEAN:{PRM:500,OFS:500,CKT:500,BRC:500,RNT:500},
    OEVM:{PRM:700,OFS:700,CKT:700,BRC:700,RNT:700},
    OWTR:{PRM:400,OFS:400,CKT:400,BRC:400,RNT:400},
    OOVH:{PRM:750,OFS:750,CKT:750,BRC:750,RNT:0},
  }
};
const K={cream:"#FBEDDF",tan:"#F3CFBD",tc:"#DC8C64",brick:"#B74F3E",rust:"#C64532",sand:"#D7C6C0",sage:"#989777",blue:"#1043BF",dk:"#8B3020",lc:"#FFF8F2",wh:"#FFFFFF"};

// â•â•â• COMPACT UI COMPONENTS â•â•â•
function Chk({label,checked,onChange}){
  return h('label',{style:{display:"flex",alignItems:"center",gap:5,cursor:"pointer",fontSize:13,whiteSpace:"nowrap"}},
    h('div',{style:{width:17,height:17,borderRadius:3,border:"2px solid "+K.brick,backgroundColor:K.wh,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0}},
      checked&&h('svg',{width:11,height:11,viewBox:"0 0 14 14",fill:"none"},h('path',{d:"M2 7L5.5 10.5L12 3.5",stroke:K.brick,strokeWidth:2.5,strokeLinecap:"round",strokeLinejoin:"round"}))),
    h('input',{type:"checkbox",checked:checked,onChange:onChange,style:{display:"none"}}),
    h('span',{style:{color:K.dk}},label))}

function NumSld({label,min,max,value,onChange}){
  return h('div',{style:{flex:1,minWidth:100}},
    h('div',{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:1}},
      h('span',{style:{fontSize:12,color:K.dk,fontWeight:600}},label),
      h('span',{style:{fontSize:13,fontWeight:700,color:K.brick,backgroundColor:K.wh,padding:"0 8px",borderRadius:4,border:"1px solid "+K.tan}},value)),
    h('input',{type:"range",min:min,max:max,value:value,onChange:function(ev){onChange(Number(ev.target.value))},style:{width:"100%",accentColor:K.brick}}))}

function PctSld({label,min,max,value,onChange}){
  var aMin=Math.min(min,max),aMax=Math.max(min,max);
  return h('div',{style:{flex:1,minWidth:100}},
    h('div',{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:1}},
      h('span',{style:{fontSize:12,color:K.dk,fontWeight:600}},label),
      h('span',{style:{fontSize:13,fontWeight:700,color:K.brick,backgroundColor:K.wh,padding:"0 8px",borderRadius:4,border:"1px solid "+K.tan}},value+"%")),
    h('input',{type:"range",min:aMin,max:aMax,value:value,onChange:function(ev){onChange(Number(ev.target.value))},style:{width:"100%",accentColor:K.brick,direction:min>max?"rtl":"ltr"}}))}

function Sel3({label,value,onChange}){
  return h('div',{style:{minWidth:80}},
    h('label',{style:{fontSize:12,color:K.dk,fontWeight:600,display:"block",marginBottom:1}},label),
    h('select',{value:String(value),onChange:function(ev){onChange(Number(ev.target.value))},style:{width:"100%",padding:"3px 6px",borderRadius:4,border:"1px solid "+K.tan,backgroundColor:K.wh,fontSize:13,color:K.dk,fontFamily:"'Assistant',sans-serif"}},
      h('option',{value:"0"},"0"),h('option',{value:"1"},"1"),h('option',{value:"2"},"2")))}

function Inc({label}){return h('span',{style:{fontSize:12,color:K.sage,fontWeight:600,padding:"1px 6px",borderRadius:4,border:"1px solid "+K.tan,backgroundColor:K.wh,whiteSpace:"nowrap"}},label+" âœ“")}

function fN(n){var r=Math.round(n),a=Math.abs(r).toLocaleString("he-IL");return r<0?"- "+a+" â‚ª":a+" â‚ª"}

function PL({label,amount,isExp,detail}){
  var r=Math.round(amount),c=r<0?"#D32F2F":r>0?(isExp?"#D32F2F":"#2E7D32"):K.dk;
  return h('div',{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"2px 0",borderBottom:"1px solid "+K.cream,fontSize:12}},
    h('div',null,h('span',{style:{color:K.dk}},label),detail&&h('span',{style:{fontSize:10,color:K.sage,marginRight:4}},detail)),
    h('span',{style:{fontWeight:600,color:c,direction:"ltr",whiteSpace:"nowrap"}},fN(r)))}

function SL({label,amount,isTotal,isExp}){
  var r=Math.round(amount),c=r<0?"#D32F2F":isExp?"#D32F2F":"#2E7D32";
  return h('div',{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:isTotal?"5px 0":"3px 0",borderTop:isTotal?"2px solid "+K.brick:"none",fontSize:isTotal?14:12}},
    h('span',{style:{fontWeight:isTotal?800:600,color:K.dk}},label),
    h('span',{style:{fontWeight:isTotal?800:600,color:c,direction:"ltr",whiteSpace:"nowrap"}},fN(r)))}

// â•â•â• MAIN APP â•â•â•
function App(){
  var D=DD,P=D.pr,I=D.inp;
  var s=useState,r=useRef;
  var [et,setET]=s("PRM");
  var [adt,setAdt]=s(15),[chd,setChd]=s(0);
  var [food,setFood]=s(false),[ksh,setKsh]=s(false);
  var [pro,setPro]=s(0),[crk,setCrk]=s(false),[cer,setCer]=s(false);
  var [flw,setFlw]=s(false),[win,setWin]=s(false);
  var [winp,setWinp]=s(false),[kit,setKit]=s(false);
  var [dsc,setDsc]=s(0),[tip,setTip]=s(15);
  var [mw,setMw]=s(0);
  var [msg,setMsg]=s("");
  var [pdf,setPdf]=s(null);
  var [pdfBusy,setPdfBusy]=s(false);
  var pdfRef=r(null);

  // Load saved PDF template
  useEffect(function(){try{var b=localStorage.getItem("hlb_pdf");if(b){var bin=atob(b);var u=new Uint8Array(bin.length);for(var i=0;i<bin.length;i++)u[i]=bin.charCodeAt(i);setPdf(u.buffer)}}catch(e){}},[]);

  // Reset on event type change
  useEffect(function(){var r=pR(I.ADT[et]);setAdt(r?r[0]:15);setChd(0);setFood(false);setKsh(false);setPro(0);setCrk(false);setCer(false);setFlw(false);setWin(false);setWinp(false);setKit(false);setDsc(0);setTip(15);setMw(0)},[et]);

  function pR(v){if(!v||v==="NR"||v==="IC")return null;var m=v.match(/(\d+)\s*-\s*(\d+)/);return m?[+m[1],+m[2]]:null}
  function nR(c){return I[c]?.[et]==="NR"}
  function iC(c){return I[c]?.[et]==="IC"}
  function isCmp(c){return I[c]?.[et]==="CMP"}

  var tot=adt+chd;
  var aR=pR(I.ADT[et]),cR=!nR("CHD")?pR(I.CHD[et]):null;
  var compW=isCmp("WTR")?Math.ceil(tot/20):0;
  var isRNT=et==="RNT";

  // â•â•â• INCOME LINES â•â•â•
  var iLines=useMemo(function(){var L=[];
    L.push({l:"×—×‘×™×œ×ª ×‘×¡×™×¡ (×¢×“ 15)",a:P.IBASE[et]||0});
    if(tot>15&&!isRNT){var x=tot-15,pp=P.IMORE[et];if(typeof pp==="number")L.push({l:"×ª×•×¡×¤×ª "+x+" × ×•×¡×¤×™×",a:x*pp,d:"("+x+"Ã—"+pp+")"})}
    else if(tot>15&&isRNT){var x2=Math.ceil(Math.max(0,tot-15)/10)*1000;if(x2>0)L.push({l:"×ª×•×¡×¤×ª ××¢×‘×¨ ×œ-15",a:x2})}
    if(!nR("CRK")&&crk&&P.ICRK[et])L.push({l:"×“××™ ×—×œ×™×¦×”",a:P.ICRK[et]});
    if(!nR("PRO")&&pro>0&&P.IPRO[et])L.push({l:"×—×œ×‘×•×Ÿ",a:pro*tot*P.IPRO[et],d:"("+tot+"Ã—"+pro+"Ã—"+P.IPRO[et]+")"});
    if(!nR("CER")&&cer&&P.ICER[et])L.push({l:"×§×¨××™×§×”",a:tot*P.ICER[et],d:"("+tot+"Ã—"+P.ICER[et]+")"});
    if(!nR("WINP")&&winp&&P.IWINP[et])L.push({l:"×™×™×Ÿ ×¤×¨×™××™×•×",a:adt*P.IWINP[et],d:"("+adt+"Ã—"+P.IWINP[et]+")"});
    if(!nR("KIT")&&kit&&P.IKIT[et])L.push({l:"××˜×‘×—",a:P.IKIT[et]});
    if(!nR("FLW")&&!iC("FLW")&&flw&&P.IFLW[et])L.push({l:"×¤×¨×—×™×",a:P.IFLW[et]});
    if(!nR("WIN")&&!iC("WIN")&&win&&P.IWIN[et])L.push({l:"×™×™×Ÿ",a:adt*P.IWIN[et],d:"("+adt+"Ã—"+P.IWIN[et]+")"});
    if(!nR("KSH")&&ksh&&P.IKSH[et])L.push({l:"×”×›×©×¨×ª ×¨×‘",a:P.IKSH[et]});
    return L},[et,adt,chd,crk,pro,cer,winp,kit,flw,win,ksh,food,tot]);

  // â•â•â• EXPENSE LINES â•â•â•
  var expLines=useMemo(function(){var L=[];
    if(!isRNT&&P.OCHEFB[et])L.push({l:"×©×£ ×‘×¡×™×¡",a:P.OCHEFB[et]});
    if(!isRNT&&P.OCHEF1[et]&&tot>35)L.push({l:"×©×£ ×ª×•×¡×¤×ª ("+(tot-35)+" ××¢×œ 35)",a:(tot-35)*P.OCHEF1[et]});
    if(!isRNT&&P.OCHEF2[et]&&tot>10)L.push({l:"×©×£ ×ª×•×¡×¤×ª ("+(tot-10)+" ××¢×œ 10)",a:(tot-10)*P.OCHEF2[et]});
    if(!isRNT&&P.OCOOK[et]){var ck=Math.floor(tot/P.OCOOK[et])*500;if(ck>0)L.push({l:"×˜×‘×— × ×•×¡×£",a:ck})}
    if(!isRNT&&P.OFOOD[et]&&!(et==="OFS"&&!food))L.push({l:"×¤×•×“×§×•×¡×˜",a:tot*P.OFOOD[et],d:"("+tot+"Ã—"+P.OFOOD[et]+")"});
    if(!isRNT&&pro>0&&P.IPRO[et]){var f15=Math.min(tot,15)*30+Math.max(0,tot-15)*15;L.push({l:"×—×•×\"×’ ×—×œ×‘×•×Ÿ",a:f15*pro})}
    if(!isRNT&&pro>0&&P.OPRO2[et])L.push({l:"×—×œ×‘×•×Ÿ ×œ×©×£",a:pro*tot*P.OPRO2[et]});
    if(!isRNT&&cer&&P.OCER[et])L.push({l:"×¢×œ×•×ª ×§×¨××™×§×”",a:tot*P.OCER[et]});
    if(!isRNT&&winp&&P.OWINP[et])L.push({l:"×¢×œ×•×ª ×™×™×Ÿ ×¤×¨×™××™×•×",a:adt*P.OWINP[et]});
    if((iC("FLW")||flw)&&P.OFLW[et])L.push({l:"×¢×œ×•×ª ×¤×¨×—×™×",a:P.OFLW[et]});
    if((iC("WIN")||win)&&P.OWIN[et])L.push({l:"×¢×œ×•×ª ×™×™×Ÿ",a:adt*P.OWIN[et]});
    if(ksh&&P.OKSH[et])L.push({l:"×¢×œ×•×ª ×”×›×©×¨×ª ×¨×‘",a:P.OKSH[et]});
    if(P.OCLEAN[et])L.push({l:"× ×§×™×•×Ÿ",a:P.OCLEAN[et]});
    if(P.OEVM[et])L.push({l:"×× ×”×œ ××™×¨×•×¢",a:P.OEVM[et]});
    if(isCmp("WTR")&&compW>0&&P.OWTR[et])L.push({l:"××œ×¦×¨×™×",a:compW*P.OWTR[et]});
    if(!isCmp("WTR")&&!nR("WTR")&&mw>0&&P.OWTR[et])L.push({l:"××œ×¦×¨×™×",a:mw*P.OWTR[et]});
    if(P.OOVH[et])L.push({l:"×ª×§×•×¨×”",a:P.OOVH[et]});
    return L},[et,adt,chd,food,ksh,pro,crk,cer,flw,win,winp,kit,tot,compW,mw]);

  var subI=iLines.reduce(function(s,x){return s+x.a},0);
  var chDisc=chd*100, dscAmt=Math.round(subI*dsc/100);
  var REV=subI-chDisc-dscAmt;
  var vatAmt=Math.round(REV*0.18), tipAmt=Math.round(REV*tip/100);
  var total=REV+vatAmt+tipAmt;
  var bonus=Math.round(REV*0.03);
  var COG=expLines.reduce(function(s,x){return s+x.a},0)+bonus;
  var GDP=REV-COG;

  // â•â•â• WHATSAPP â•â•â•
  function genWA(){
    var eLabel=D.eL[et],fm=function(n){return Math.round(n).toLocaleString("he-IL")};
    var m="ğŸ›ï¸ *×—×•×‘×•×ª ×”×œ×‘×‘×•×ª - ×”×¦×¢×ª ××—×™×¨*\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ“‹ *×¤×¨×˜×™ ×”××™×¨×•×¢:*\nâ–«ï¸ ×¡×•×’ ××™×¨×•×¢: "+eLabel+"\nâ–«ï¸ ××¡×¤×¨ ××‘×•×’×¨×™×: "+adt+"\n";
    if(!nR("CHD")&&chd>0)m+="â–«ï¸ ××¡×¤×¨ ×™×œ×“×™×: "+chd+"\n";
    m+="â–«ï¸ ×¡×”\"×› ××•×¨×—×™×: "+tot+"\n\nğŸ½ï¸ *××” ×›×•×œ×œ ×”××™×¨×•×¢:*\n";
    if(iC("FOD"))m+="âœ… ××•×›×œ - ×›×œ×•×œ ×‘×—×‘×™×œ×”\n";else if(!nR("FOD")&&food)m+="âœ… ××•×›×œ\n";
    if(iC("WIN"))m+="âœ… ×™×™×Ÿ - ×›×œ×•×œ ×‘×—×‘×™×œ×”\n";else if(!nR("WIN")&&win)m+="âœ… ×™×™×Ÿ\n";
    if(!nR("WINP")&&winp)m+="âœ… ×ª×•×¡×¤×ª ×™×™×Ÿ ×¤×¨×™××™×•×\n";
    if(iC("FLW"))m+="âœ… ×¡×™×“×•×¨ ×¤×¨×—×™× - ×›×œ×•×œ ×‘×—×‘×™×œ×”\n";else if(!nR("FLW")&&flw)m+="âœ… ×¡×™×“×•×¨ ×¤×¨×—×™×\n";
    if(!nR("PRO")&&pro>0)m+="âœ… ×ª×•×¡×¤×ª ×× ×•×ª ×—×œ×‘×•×Ÿ: "+pro+" ×œ××“×\n";
    if(!nR("CER")&&cer)m+="âœ… ×¡×“× ×ª ×§×¨××™×§×”\n";
    if(!nR("KSH")&&ksh)m+="âœ… ×”×›×©×¨×ª ×¨×‘\n";
    if(!nR("CRK")&&crk)m+="âœ… ×“××™ ×—×œ×™×¦×”\n";
    if(!nR("WTR")){var wc=isCmp("WTR")?compW:mw;if(wc>0)m+="âœ… ××œ×¦×¨×™×: "+wc+"\n"}
    if(!nR("KIT")&&kit)m+="âœ… ×©×™××•×© ×‘××˜×‘×—\n";
    m+="\nğŸ’° *×¤×™×¨×•×˜ ××—×™×¨×™×:*\n";
    iLines.forEach(function(x){m+="â–«ï¸ "+x.l+": "+fm(x.a)+" â‚ª\n"});m+="\n";
    if(chDisc>0||dscAmt>0){m+="ğŸ·ï¸ *×”× ×—×•×ª:*\n";if(chDisc>0)m+="â–«ï¸ ×”× ×—×ª ×™×œ×“×™× ("+chd+"Ã—100): -"+fm(chDisc)+" â‚ª\n";if(dscAmt>0)m+="â–«ï¸ ×”× ×—×” "+dsc+"%: -"+fm(dscAmt)+" â‚ª\n";m+="\n"}
    m+="â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nğŸ“Š *×¡×™×›×•× ×œ×ª×©×œ×•×:*\nâ–«ï¸ ×¡×”\"×› ×œ×¤× ×™ ××¢\"×: "+fm(REV)+" â‚ª\nâ–«ï¸ ××¢\"× (18%): "+fm(vatAmt)+" â‚ª\n";
    if(tipAmt>0)m+="â–«ï¸ ×˜×™×¤ ("+tip+"%): "+fm(tipAmt)+" â‚ª\n";
    m+="\nğŸ’ *×¡×”\"×› ×œ×ª×©×œ×•×: "+fm(total)+" â‚ª*\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n_×—×•×‘×•×ª ×”×œ×‘×‘×•×ª - ×—×•×•×™×” ×§×•×œ×™× ×¨×™×ª_\n_events.hovothalevavot.com_";
    return m}

  function copyWA(){var m=genWA();var ta=document.createElement("textarea");ta.value=m;ta.style.cssText="position:fixed;left:-9999px;opacity:0";document.body.appendChild(ta);ta.focus();ta.select();try{document.execCommand("copy");setMsg("âœ“ ×”×•×¢×ª×§!")}catch(e){setMsg("×©×’×™××”")}document.body.removeChild(ta);setTimeout(function(){setMsg("")},2500)}

  // â•â•â• PDF UPLOAD â•â•â•
  function handlePdf(ev){var f=ev.target.files&&ev.target.files[0];if(!f)return;var r=new FileReader();r.onload=function(v){var ab=v.target.result;setPdf(ab);try{var b=new Uint8Array(ab);var s="";for(var i=0;i<b.length;i++)s+=String.fromCharCode(b[i]);localStorage.setItem("hlb_pdf",btoa(s));setMsg("âœ“ ×ª×‘× ×™×ª × ×©××¨×”!")}catch(e){setMsg("âœ“ ×ª×‘× ×™×ª × ×˜×¢× ×”")}setTimeout(function(){setMsg("")},2500)};r.readAsArrayBuffer(f);ev.target.value=""}

  // â•â•â• PDF GENERATION â•â•â•
  async function genPDF(){
    if(!pdf){pdfRef.current&&pdfRef.current.click();return}
    if(!window.PDFLib){setMsg("âš ï¸ ×××ª×™×Ÿ ×œ×˜×¢×™× ×”...");setTimeout(function(){setMsg("")},2000);return}
    setPdfBusy(true);setMsg("××™×™×¦×¨ PDF...");
    try{
      var PDFDocument=window.PDFLib.PDFDocument,rgb=window.PDFLib.rgb;
      var tpl=await PDFDocument.load(pdf),doc=await PDFDocument.create();
      var cp=await doc.copyPages(tpl,[0,1]);doc.addPage(cp[0]);doc.addPage(cp[1]);
      var sz=tpl.getPage(2).getSize(),pw=sz.width,ph=sz.height;
      var cp3=await doc.copyPages(tpl,[2]);doc.addPage(cp3[0]);var pg3=doc.getPage(2);
      pg3.drawRectangle({x:0,y:0,width:pw,height:ph-90,color:rgb(251/255,237/255,223/255)});
      var wt=genWA(),sc=2,cW2=Math.round(pw*sc),cH=Math.round((ph-100)*sc);
      var cvs=document.createElement("canvas");cvs.width=cW2;cvs.height=cH;var ctx=cvs.getContext("2d");
      ctx.fillStyle="#FBEDDF";ctx.fillRect(0,0,cW2,cH);
      ctx.textAlign="right";ctx.direction="rtl";var rX=cW2-50*sc;var y2=40*sc;var nS=11*sc,hS=13*sc,tS=15*sc,mg=50*sc;
      var lines=wt.split("\n");
      for(var i=0;i<lines.length;i++){
        if(y2>cH-20)break;var ln=lines[i].trim();if(!ln){y2+=nS*0.6;continue}
        if(ln.indexOf("â”â”â”")>=0){ctx.strokeStyle="#C8B4AA";ctx.lineWidth=sc;ctx.beginPath();ctx.moveTo(mg,y2);ctx.lineTo(cW2-mg,y2);ctx.stroke();y2+=nS*0.6;continue}
        var isB=ln.indexOf("*")>=0,dt=ln.replace(/\*/g,"").replace(/â”+/g,"");
        var isT=dt.indexOf("×¡×”\"×› ×œ×ª×©×œ×•×")>=0,isM=dt.indexOf("×—×•×‘×•×ª ×”×œ×‘×‘×•×ª - ×”×¦×¢×ª ××—×™×¨")>=0;
        var isS=dt.indexOf("×¤×¨×˜×™ ×”××™×¨×•×¢:")>=0||dt.indexOf("××” ×›×•×œ×œ ×”××™×¨×•×¢:")>=0||dt.indexOf("×¤×™×¨×•×˜ ××—×™×¨×™×:")>=0||dt.indexOf("×¡×™×›×•× ×œ×ª×©×œ×•×:")>=0||dt.indexOf("×”× ×—×•×ª:")>=0;
        var fs=nS,fw="400",cl="#503228";
        if(isT){fs=tS;fw="800";cl="#1043BF"}else if(isM){fs=hS;fw="700";cl="#1043BF"}else if(isS||isB){fs=nS*1.05;fw="700";cl="#1043BF"}
        ctx.font=fw+" "+fs+"px 'Assistant','Heebo','Arial Hebrew','Segoe UI',Arial,sans-serif";ctx.fillStyle=cl;ctx.fillText(dt,rX,y2);y2+=fs*1.5}
      var pB=cvs.toDataURL("image/png").split(",")[1];
      var pI=await doc.embedPng(Uint8Array.from(atob(pB),function(c){return c.charCodeAt(0)}));
      pg3.drawImage(pI,{x:5,y:5,width:pw-10,height:ph-100});
      if(tpl.getPageCount()>=4){var cp4=await doc.copyPages(tpl,[3]);doc.addPage(cp4[0])}
      var bytes=await doc.save();var blob=new Blob([bytes],{type:"application/pdf"});
      var u=URL.createObjectURL(blob),a=document.createElement("a");a.href=u;a.download="×”×¦×¢×ª_××—×™×¨_×—×•×‘×•×ª_×”×œ×‘×‘×•×ª.pdf";document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(u);
      setMsg("âœ“ PDF ×”×•×¨×“!");setTimeout(function(){setMsg("")},3000);
    }catch(err){console.error(err);setMsg("×©×’×™××”: "+err.message);setTimeout(function(){setMsg("")},4000)}
    finally{setPdfBusy(false)}}

  // â•â•â• RENDER â•â•â•
  var cd={backgroundColor:K.wh,borderRadius:10,padding:"10px 12px",marginBottom:8,boxShadow:"0 1px 8px rgba(139,48,32,0.06)",border:"1px solid "+K.tan};
  var rw={display:"flex",gap:8,flexWrap:"wrap",alignItems:"flex-end"};
  var ckRow={display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"};

  return h('div',{style:{minHeight:"100vh",background:"linear-gradient(170deg,"+K.lc+" 0%,"+K.cream+" 40%,"+K.sand+" 100%)",fontFamily:"'Assistant','Heebo',sans-serif",direction:"rtl"}},

    // Header
    h('div',{style:{background:"linear-gradient(135deg,"+K.brick+" 0%,"+K.rust+" 50%,"+K.dk+" 100%)",padding:"12px 16px 10px",textAlign:"center",boxShadow:"0 3px 12px rgba(139,48,32,0.3)"}},
      h('h1',{style:{margin:0,fontSize:22,fontWeight:800,color:K.cream,fontFamily:"'Playfair Display',serif"}},"×—×•×‘×•×ª ×”×œ×‘×‘×•×ª"),
      h('p',{style:{margin:"2px 0 0",fontSize:11,color:K.tan,fontWeight:300,letterSpacing:2}},"××—×©×‘×•×Ÿ ×ª××—×•×¨ ××™×¨×•×¢×™×")),

    h('div',{style:{maxWidth:900,margin:"0 auto",padding:"10px 10px 30px"}},

      // Event Type row
      h('div',{style:Object.assign({},cd,{display:"flex",alignItems:"center",gap:10})},
        h('label',{style:{fontSize:14,fontWeight:700,color:K.brick,whiteSpace:"nowrap"}},"×¡×•×’ ××™×¨×•×¢"),
        h('select',{value:et,onChange:function(ev){setET(ev.target.value)},style:{flex:1,padding:"6px 10px",borderRadius:6,border:"2px solid "+K.brick,backgroundColor:K.lc,fontSize:14,fontWeight:600,color:K.dk,fontFamily:"'Assistant',sans-serif"}},
          D.eventTypes.map(function(t){return h('option',{key:t,value:t},D.eL[t])}))),

      // Parameters Card
      h('div',{style:cd},
        h('div',{style:{fontSize:14,fontWeight:700,color:K.brick,marginBottom:6,borderBottom:"2px solid "+K.cream,paddingBottom:4}},"×¤×¨××˜×¨×™×"),

        // Row 1: Adults + Children side by side
        h('div',{style:rw},
          aR&&h(NumSld,{label:"××‘×•×’×¨×™×",min:aR[0],max:aR[1],value:adt,onChange:setAdt}),
          cR&&h(NumSld,{label:"×™×œ×“×™×",min:cR[0],max:cR[1],value:chd,onChange:setChd})),

        // Row 2: Total + Waiters + Protein
        h('div',{style:Object.assign({},rw,{marginTop:6})},
          h('div',{style:{display:"flex",alignItems:"center",gap:4,fontSize:12,color:K.dk}},
            h('span',{style:{fontWeight:600}},"×¡×”×´×›:"),
            h('span',{style:{fontWeight:700,color:K.brick,fontSize:14}},tot)),
          isCmp("WTR")&&h('div',{style:{display:"flex",alignItems:"center",gap:4,fontSize:12,color:K.dk}},
            h('span',{style:{fontWeight:600}},"××œ×¦×¨×™×:"),
            h('span',{style:{fontWeight:700,color:K.brick,fontSize:14}},compW)),
          !nR("WTR")&&!isCmp("WTR")&&h(Sel3,{label:"××œ×¦×¨×™×",value:mw,onChange:setMw}),
          !nR("PRO")&&h(Sel3,{label:"×—×œ×‘×•×Ÿ",value:pro,onChange:setPro})),

        // Row 3: Checkboxes
        h('div',{style:Object.assign({},ckRow,{marginTop:6})},
          !nR("FOD")&&!iC("FOD")&&h(Chk,{label:"××•×›×œ",checked:food,onChange:function(ev){setFood(ev.target.checked)}}),
          iC("FOD")&&h(Inc,{label:"××•×›×œ"}),
          !nR("KSH")&&h(Chk,{label:"×”×›×©×¨×ª ×¨×‘",checked:ksh,onChange:function(ev){setKsh(ev.target.checked)}}),
          !nR("CRK")&&h(Chk,{label:"×“××™ ×—×œ×™×¦×”",checked:crk,onChange:function(ev){setCrk(ev.target.checked)}}),
          !nR("CER")&&h(Chk,{label:"×§×¨××™×§×”",checked:cer,onChange:function(ev){setCer(ev.target.checked)}})),

        // Row 4: More checkboxes
        h('div',{style:Object.assign({},ckRow,{marginTop:4})},
          !nR("FLW")&&!iC("FLW")&&h(Chk,{label:"×¤×¨×—×™×",checked:flw,onChange:function(ev){setFlw(ev.target.checked)}}),
          iC("FLW")&&h(Inc,{label:"×¤×¨×—×™×"}),
          !nR("WIN")&&!iC("WIN")&&h(Chk,{label:"×™×™×Ÿ",checked:win,onChange:function(ev){setWin(ev.target.checked)}}),
          iC("WIN")&&h(Inc,{label:"×™×™×Ÿ"}),
          !nR("WINP")&&h(Chk,{label:"×™×™×Ÿ ×¤×¨×™××™×•×",checked:winp,onChange:function(ev){setWinp(ev.target.checked)}}),
          !nR("KIT")&&h(Chk,{label:"××˜×‘×—",checked:kit,onChange:function(ev){setKit(ev.target.checked)}})),

        // Row 5: Discount + Tip sliders side by side
        h('div',{style:Object.assign({},rw,{marginTop:6})},
          h(PctSld,{label:"×”× ×—×”",min:0,max:15,value:dsc,onChange:setDsc}),
          h(PctSld,{label:"×˜×™×¤",min:0,max:15,value:tip,onChange:setTip}))),

      // â•â•â• PRICING TWO COLUMNS â•â•â•
      h('div',{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:8}},

        // Income
        h('div',{style:cd},
          h('div',{style:{fontSize:13,fontWeight:700,color:"#2E7D32",marginBottom:6,borderBottom:"2px solid #C8E6C9",paddingBottom:3}},"ğŸ’° ×”×›× ×¡×•×ª"),
          iLines.map(function(x,i){return h(PL,{key:i,label:x.l,amount:x.a,detail:x.d})}),
          h('div',{style:{height:1,backgroundColor:K.tan,margin:"4px 0"}}),
          h(SL,{label:"×¡×”×´×› ×‘×¨×•×˜×•",amount:subI}),
          chDisc>0&&h(PL,{label:"×”× ×—×ª ×™×œ×“×™× ("+chd+"Ã—100)",amount:-chDisc}),
          dscAmt>0&&h(PL,{label:"×”× ×—×” ("+dsc+"%)",amount:-dscAmt}),
          h(SL,{label:"×œ×¤× ×™ ××¢×´× (REV)",amount:REV}),
          h(PL,{label:"××¢\"× (18%)",amount:vatAmt}),
          tipAmt>0&&h(PL,{label:"×˜×™×¤ ("+tip+"%)",amount:tipAmt}),
          h(SL,{label:"×¡×”×´×› ×œ×ª×©×œ×•×",amount:total,isTotal:true})),

        // Expenses
        h('div',{style:cd},
          h('div',{style:{fontSize:13,fontWeight:700,color:"#D32F2F",marginBottom:6,borderBottom:"2px solid #FFCDD2",paddingBottom:3}},"ğŸ“Š ×”×•×¦××•×ª"),
          expLines.map(function(x,i){return h(PL,{key:i,label:x.l,amount:x.a,detail:x.d,isExp:true})}),
          h('div',{style:{height:1,backgroundColor:K.tan,margin:"4px 0"}}),
          h(PL,{label:"×‘×•× ×•×¡ ××›×™×¨×•×ª (3%)",amount:bonus,isExp:true}),
          h(SL,{label:"×¡×”×´×› ×”×•×¦××•×ª (COG)",amount:COG,isExp:true}))),

      // Gross Profit
      h('div',{style:Object.assign({},cd,{border:"2px solid "+(GDP>=0?"#2E7D32":"#D32F2F"),padding:"8px 12px"})},
        h('div',{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},
          h('span',{style:{fontSize:15,fontWeight:800,color:K.dk}},"×¨×•×•×— ×’×•×œ××™ (GDP)"),
          h('span',{style:{fontSize:18,fontWeight:800,color:GDP>=0?"#2E7D32":"#D32F2F",direction:"ltr"}},fN(GDP))),
        h('div',{style:{display:"flex",justifyContent:"space-between",marginTop:3,fontSize:11,color:K.sage}},
          h('span',null,"×¨×•×•×—: "+(REV>0?Math.round(GDP/REV*100):0)+"%"),
          h('span',null,"REV: "+fN(REV)+" | COG: "+fN(COG)))),

      // Buttons row
      h('div',{style:{display:"flex",gap:8,marginTop:4}},
        h('button',{onClick:copyWA,style:{flex:1,padding:"10px",borderRadius:10,backgroundColor:"#25D366",color:K.wh,border:"none",cursor:"pointer",fontFamily:"'Assistant',sans-serif",fontSize:15,fontWeight:700,display:"flex",alignItems:"center",justifyContent:"center",gap:6}},h('span',null,"ğŸ“‹"),h('span',null,"×”×¢×ª×§ ×œ×•×•×˜×¡××¤")),
        h('button',{onClick:genPDF,disabled:pdfBusy,style:{flex:1,padding:"10px",borderRadius:10,backgroundColor:pdf?K.brick:K.sand,color:K.wh,border:"none",cursor:pdf?"pointer":"default",fontFamily:"'Assistant',sans-serif",fontSize:15,fontWeight:700,display:"flex",alignItems:"center",justifyContent:"center",gap:6,opacity:pdfBusy?0.7:1}},h('span',null,"ğŸ“„"),h('span',null,pdfBusy?"××™×™×¦×¨...":pdf?"×”×•×¨×“ PDF":"×˜×¢×Ÿ ×ª×‘× ×™×ª PDF"))),

      // Hidden PDF input
      h('input',{ref:pdfRef,type:"file",accept:".pdf",onChange:handlePdf,style:{display:"none"}}),

      // Status
      msg&&h('div',{style:{textAlign:"center",marginTop:6,padding:"5px 12px",borderRadius:6,backgroundColor:msg.indexOf("×©×’×™××”")>=0||msg.indexOf("âš ï¸")>=0?"#FFEBEE":"#E8F5E9",color:msg.indexOf("×©×’×™××”")>=0||msg.indexOf("âš ï¸")>=0?"#D32F2F":"#2E7D32",fontWeight:700,fontSize:13}},msg))
  )
}

ReactDOM.render(h(App),document.getElementById("root"));
</script>
</body>
</html>
